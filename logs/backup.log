Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7ff48fd776d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ff48f2c3880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ff48f2c3880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7ff48f2c3910>
  File "apps/frappe/frappe/utils/backups.py", line 195, in get_backup
    self.delete_if_step_fails(self.take_dump, self.backup_path_db)
      self = <frappe.utils.backups.BackupGenerator object at 0x7ff48f2c3910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7ff48f2c3910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7ff48f2c3910>>
      paths = ('./site1.local/private/backups/20241204_173002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241204_173002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7ff48f2c3910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7ff48f2c3910>>
      paths = ('./site1.local/private/backups/20241204_173002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241204_173002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 427, in take_dump
    with gzip.open(self.backup_path_db, "wt") as f:
      shlex = <module 'shlex' from '/usr/lib/python3.10/shlex.py'>
      frappe = <module 'frappe' from 'apps/frappe/frappe/__init__.py'>
      get_app_branch = <function get_app_branch at 0x7ff48fd67640>
      gzip_exc = '/usr/bin/gzip'
      database_header_content = ['begin frappe metadata', '[frappe]', 'version = 15.49.1', 'branch = version-15', 'end frappe metadata', '']
      generated_header = '-- begin frappe metadata\n-- [frappe]\n-- version = 15.49.1\n-- branch = version-15\n-- end frappe metadata\n-- \n'
      self = <frappe.utils.backups.BackupGenerator object at 0x7ff48f2c3910>
  File "/usr/lib/python3.10/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
      filename = './site1.local/private/backups/20241204_173002-site1_local-database.sql.gz'
      mode = 'wt'
      compresslevel = 9
      encoding = None
      errors = None
      newline = None
      gz_mode = 'w'
  File "/usr/lib/python3.10/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
      self = <exception while printing> Traceback (most recent call last):
          File "env/lib/python3.10/site-packages/traceback_with_variables/core.py", line 222, in _to_cropped_str
            raw = print_(obj)
          File "/usr/lib/python3.10/gzip.py", line 229, in __repr__
            s = repr(self.fileobj)
        AttributeError: 'GzipFile' object has no attribute 'fileobj'
        
      filename = './site1.local/private/backups/20241204_173002-site1_local-database.sql.gz'
      mode = 'wb'
      compresslevel = 9
      fileobj = None
      mtime = None
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241204_173002-site1_local-database.sql.gz'
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 114, in <module>
    main()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 20, in main
    click.Group(commands=commands)(prog_name="bench")
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/__init__.py", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/site.py", line 882, in backup
    odb.print_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 339, in print_summary
    backup_summary = self.get_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 318, in get_summary
    "size": get_file_size(self.backup_path_db, format=True),
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/__init__.py", line 952, in get_file_size
    num = os.path.getsize(path)
  File "/usr/lib/python3.10/genericpath.py", line 50, in getsize
    return os.stat(filename).st_size
FileNotFoundError: [Errno 2] No such file or directory: './site1.local/private/backups/20241204_173002-site1_local-database.sql.gz'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241204_173002-site1_local-database.sql.gz

Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f522d76b6d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f522ccb3880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f522ccb3880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7f522ccb3910>
  File "apps/frappe/frappe/utils/backups.py", line 195, in get_backup
    self.delete_if_step_fails(self.take_dump, self.backup_path_db)
      self = <frappe.utils.backups.BackupGenerator object at 0x7f522ccb3910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7f522ccb3910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f522ccb3910>>
      paths = ('./site1.local/private/backups/20241204_233002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241204_233002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f522ccb3910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f522ccb3910>>
      paths = ('./site1.local/private/backups/20241204_233002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241204_233002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 427, in take_dump
    with gzip.open(self.backup_path_db, "wt") as f:
      shlex = <module 'shlex' from '/usr/lib/python3.10/shlex.py'>
      frappe = <module 'frappe' from 'apps/frappe/frappe/__init__.py'>
      get_app_branch = <function get_app_branch at 0x7f522d75b640>
      gzip_exc = '/usr/bin/gzip'
      database_header_content = ['begin frappe metadata', '[frappe]', 'version = 15.49.1', 'branch = version-15', 'end frappe metadata', '']
      generated_header = '-- begin frappe metadata\n-- [frappe]\n-- version = 15.49.1\n-- branch = version-15\n-- end frappe metadata\n-- \n'
      self = <frappe.utils.backups.BackupGenerator object at 0x7f522ccb3910>
  File "/usr/lib/python3.10/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
      filename = './site1.local/private/backups/20241204_233002-site1_local-database.sql.gz'
      mode = 'wt'
      compresslevel = 9
      encoding = None
      errors = None
      newline = None
      gz_mode = 'w'
  File "/usr/lib/python3.10/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
      self = <exception while printing> Traceback (most recent call last):
          File "env/lib/python3.10/site-packages/traceback_with_variables/core.py", line 222, in _to_cropped_str
            raw = print_(obj)
          File "/usr/lib/python3.10/gzip.py", line 229, in __repr__
            s = repr(self.fileobj)
        AttributeError: 'GzipFile' object has no attribute 'fileobj'
        
      filename = './site1.local/private/backups/20241204_233002-site1_local-database.sql.gz'
      mode = 'wb'
      compresslevel = 9
      fileobj = None
      mtime = None
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241204_233002-site1_local-database.sql.gz'
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 114, in <module>
    main()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 20, in main
    click.Group(commands=commands)(prog_name="bench")
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/__init__.py", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/site.py", line 882, in backup
    odb.print_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 339, in print_summary
    backup_summary = self.get_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 318, in get_summary
    "size": get_file_size(self.backup_path_db, format=True),
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/__init__.py", line 952, in get_file_size
    num = os.path.getsize(path)
  File "/usr/lib/python3.10/genericpath.py", line 50, in getsize
    return os.stat(filename).st_size
FileNotFoundError: [Errno 2] No such file or directory: './site1.local/private/backups/20241204_233002-site1_local-database.sql.gz'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241204_233002-site1_local-database.sql.gz

Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7fbde0e636d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7fbde03ab880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7fbde03ab880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7fbde03ab910>
  File "apps/frappe/frappe/utils/backups.py", line 195, in get_backup
    self.delete_if_step_fails(self.take_dump, self.backup_path_db)
      self = <frappe.utils.backups.BackupGenerator object at 0x7fbde03ab910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7fbde03ab910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7fbde03ab910>>
      paths = ('./site1.local/private/backups/20241205_053001-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241205_053001-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7fbde03ab910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7fbde03ab910>>
      paths = ('./site1.local/private/backups/20241205_053001-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241205_053001-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 427, in take_dump
    with gzip.open(self.backup_path_db, "wt") as f:
      shlex = <module 'shlex' from '/usr/lib/python3.10/shlex.py'>
      frappe = <module 'frappe' from 'apps/frappe/frappe/__init__.py'>
      get_app_branch = <function get_app_branch at 0x7fbde0e53640>
      gzip_exc = '/usr/bin/gzip'
      database_header_content = ['begin frappe metadata', '[frappe]', 'version = 15.49.1', 'branch = version-15', 'end frappe metadata', '']
      generated_header = '-- begin frappe metadata\n-- [frappe]\n-- version = 15.49.1\n-- branch = version-15\n-- end frappe metadata\n-- \n'
      self = <frappe.utils.backups.BackupGenerator object at 0x7fbde03ab910>
  File "/usr/lib/python3.10/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
      filename = './site1.local/private/backups/20241205_053001-site1_local-database.sql.gz'
      mode = 'wt'
      compresslevel = 9
      encoding = None
      errors = None
      newline = None
      gz_mode = 'w'
  File "/usr/lib/python3.10/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
      self = <exception while printing> Traceback (most recent call last):
          File "env/lib/python3.10/site-packages/traceback_with_variables/core.py", line 222, in _to_cropped_str
            raw = print_(obj)
          File "/usr/lib/python3.10/gzip.py", line 229, in __repr__
            s = repr(self.fileobj)
        AttributeError: 'GzipFile' object has no attribute 'fileobj'
        
      filename = './site1.local/private/backups/20241205_053001-site1_local-database.sql.gz'
      mode = 'wb'
      compresslevel = 9
      fileobj = None
      mtime = None
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241205_053001-site1_local-database.sql.gz'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241205_053001-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-05 05:30:04.657930
Config  : ./site1.local/private/backups/20241205_053001-site1_local-site_config_backup.json 158.0B
Database: ./site1.local/private/backups/20241205_053001-site1_local-database.sql.gz         1.2MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241205_113002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-05 11:30:04.124737
Config  : ./site1.local/private/backups/20241205_113002-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241205_113002-site1_local-database.sql.gz         2.2MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241205_113002-site1_local-database.sql.gz

Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7ffbe86636d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ffbe7baf880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ffbe7baf880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7ffbe7baf910>
  File "apps/frappe/frappe/utils/backups.py", line 196, in get_backup
    self.delete_if_step_fails(self.copy_site_config, self.backup_path_conf)
      self = <frappe.utils.backups.BackupGenerator object at 0x7ffbe7baf910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7ffbe7baf910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7ffbe7baf910>>
      paths = ('./site1.local/private/backups/20241205_113002-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241205_113002-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7ffbe7baf910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7ffbe7baf910>>
      paths = ('./site1.local/private/backups/20241205_113002-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241205_113002-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 379, in copy_site_config
    with open(site_config_backup_path, "w") as n, open(site_config_path) as c:
      self = <frappe.utils.backups.BackupGenerator object at 0x7ffbe7baf910>
      site_config_backup_path = './site1.local/private/backups/20241205_113002-site1_local-site_config_backup.json'
      site_config_path = './site1.local/site_config.json'
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241205_113002-site1_local-site_config_backup.json'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241205_173002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-05 17:30:04.514129
Config  : ./site1.local/private/backups/20241205_173002-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241205_173002-site1_local-database.sql.gz         2.2MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241205_173002-site1_local-database.sql.gz

Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f1fa0f636d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f1fa04ab880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f1fa04ab880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7f1fa04ab910>
  File "apps/frappe/frappe/utils/backups.py", line 196, in get_backup
    self.delete_if_step_fails(self.copy_site_config, self.backup_path_conf)
      self = <frappe.utils.backups.BackupGenerator object at 0x7f1fa04ab910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7f1fa04ab910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7f1fa04ab910>>
      paths = ('./site1.local/private/backups/20241205_173002-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241205_173002-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f1fa04ab910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7f1fa04ab910>>
      paths = ('./site1.local/private/backups/20241205_173002-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241205_173002-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 379, in copy_site_config
    with open(site_config_backup_path, "w") as n, open(site_config_path) as c:
      self = <frappe.utils.backups.BackupGenerator object at 0x7f1fa04ab910>
      site_config_backup_path = './site1.local/private/backups/20241205_173002-site1_local-site_config_backup.json'
      site_config_path = './site1.local/site_config.json'
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241205_173002-site1_local-site_config_backup.json'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241205_233002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-05 23:30:04.838944
Config  : ./site1.local/private/backups/20241205_233002-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241205_233002-site1_local-database.sql.gz         2.2MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241205_233002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-05 23:30:04.844442
Config  : ./site1.local/private/backups/20241205_233002-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241205_233002-site1_local-database.sql.gz         2.5MiB
Backup for Site site1.local has been successfully completed
Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f0cde36b6d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f0cdd8b7880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f0cdd8b7880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7f0cdd8b7910>
  File "apps/frappe/frappe/utils/backups.py", line 195, in get_backup
    self.delete_if_step_fails(self.take_dump, self.backup_path_db)
      self = <frappe.utils.backups.BackupGenerator object at 0x7f0cdd8b7910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7f0cdd8b7910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f0cdd8b7910>>
      paths = ('./site1.local/private/backups/20241206_053001-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241206_053001-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f0cdd8b7910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f0cdd8b7910>>
      paths = ('./site1.local/private/backups/20241206_053001-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241206_053001-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 427, in take_dump
    with gzip.open(self.backup_path_db, "wt") as f:
      shlex = <module 'shlex' from '/usr/lib/python3.10/shlex.py'>
      frappe = <module 'frappe' from 'apps/frappe/frappe/__init__.py'>
      get_app_branch = <function get_app_branch at 0x7f0cde35b640>
      gzip_exc = '/usr/bin/gzip'
      database_header_content = ['begin frappe metadata', '[frappe]', 'version = 15.49.1', 'branch = version-15', 'end frappe metadata', '']
      generated_header = '-- begin frappe metadata\n-- [frappe]\n-- version = 15.49.1\n-- branch = version-15\n-- end frappe metadata\n-- \n'
      self = <frappe.utils.backups.BackupGenerator object at 0x7f0cdd8b7910>
  File "/usr/lib/python3.10/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
      filename = './site1.local/private/backups/20241206_053001-site1_local-database.sql.gz'
      mode = 'wt'
      compresslevel = 9
      encoding = None
      errors = None
      newline = None
      gz_mode = 'w'
  File "/usr/lib/python3.10/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
      self = <exception while printing> Traceback (most recent call last):
          File "env/lib/python3.10/site-packages/traceback_with_variables/core.py", line 222, in _to_cropped_str
            raw = print_(obj)
          File "/usr/lib/python3.10/gzip.py", line 229, in __repr__
            s = repr(self.fileobj)
        AttributeError: 'GzipFile' object has no attribute 'fileobj'
        
      filename = './site1.local/private/backups/20241206_053001-site1_local-database.sql.gz'
      mode = 'wb'
      compresslevel = 9
      fileobj = None
      mtime = None
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241206_053001-site1_local-database.sql.gz'
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 114, in <module>
    main()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 20, in main
    click.Group(commands=commands)(prog_name="bench")
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/__init__.py", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/site.py", line 882, in backup
    odb.print_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 339, in print_summary
    backup_summary = self.get_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 318, in get_summary
    "size": get_file_size(self.backup_path_db, format=True),
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/__init__.py", line 952, in get_file_size
    num = os.path.getsize(path)
  File "/usr/lib/python3.10/genericpath.py", line 50, in getsize
    return os.stat(filename).st_size
FileNotFoundError: [Errno 2] No such file or directory: './site1.local/private/backups/20241206_053001-site1_local-database.sql.gz'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241206_053001-site1_local-database.sql.gz

set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241206_113002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-06 11:30:04.562459
Config  : ./site1.local/private/backups/20241206_113002-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241206_113002-site1_local-database.sql.gz         2.2MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241206_113002-site1_local-database.sql.gz

Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7fa307a7f6d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7fa306fcb880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7fa306fcb880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7fa306fcb910>
  File "apps/frappe/frappe/utils/backups.py", line 196, in get_backup
    self.delete_if_step_fails(self.copy_site_config, self.backup_path_conf)
      self = <frappe.utils.backups.BackupGenerator object at 0x7fa306fcb910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7fa306fcb910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7fa306fcb910>>
      paths = ('./site1.local/private/backups/20241206_113002-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241206_113002-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7fa306fcb910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7fa306fcb910>>
      paths = ('./site1.local/private/backups/20241206_113002-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241206_113002-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 379, in copy_site_config
    with open(site_config_backup_path, "w") as n, open(site_config_path) as c:
      self = <frappe.utils.backups.BackupGenerator object at 0x7fa306fcb910>
      site_config_backup_path = './site1.local/private/backups/20241206_113002-site1_local-site_config_backup.json'
      site_config_path = './site1.local/site_config.json'
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241206_113002-site1_local-site_config_backup.json'
Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7fd05ed776d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7fd05e2c3880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7fd05e2c3880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7fd05e2c3910>
  File "apps/frappe/frappe/utils/backups.py", line 195, in get_backup
    self.delete_if_step_fails(self.take_dump, self.backup_path_db)
      self = <frappe.utils.backups.BackupGenerator object at 0x7fd05e2c3910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7fd05e2c3910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7fd05e2c3910>>
      paths = ('./site1.local/private/backups/20241206_173002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241206_173002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7fd05e2c3910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7fd05e2c3910>>
      paths = ('./site1.local/private/backups/20241206_173002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241206_173002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 427, in take_dump
    with gzip.open(self.backup_path_db, "wt") as f:
      shlex = <module 'shlex' from '/usr/lib/python3.10/shlex.py'>
      frappe = <module 'frappe' from 'apps/frappe/frappe/__init__.py'>
      get_app_branch = <function get_app_branch at 0x7fd05ed63640>
      gzip_exc = '/usr/bin/gzip'
      database_header_content = ['begin frappe metadata', '[frappe]', 'version = 15.49.1', 'branch = version-15', 'end frappe metadata', '']
      generated_header = '-- begin frappe metadata\n-- [frappe]\n-- version = 15.49.1\n-- branch = version-15\n-- end frappe metadata\n-- \n'
      self = <frappe.utils.backups.BackupGenerator object at 0x7fd05e2c3910>
  File "/usr/lib/python3.10/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
      filename = './site1.local/private/backups/20241206_173002-site1_local-database.sql.gz'
      mode = 'wt'
      compresslevel = 9
      encoding = None
      errors = None
      newline = None
      gz_mode = 'w'
  File "/usr/lib/python3.10/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
      self = <exception while printing> Traceback (most recent call last):
          File "env/lib/python3.10/site-packages/traceback_with_variables/core.py", line 222, in _to_cropped_str
            raw = print_(obj)
          File "/usr/lib/python3.10/gzip.py", line 229, in __repr__
            s = repr(self.fileobj)
        AttributeError: 'GzipFile' object has no attribute 'fileobj'
        
      filename = './site1.local/private/backups/20241206_173002-site1_local-database.sql.gz'
      mode = 'wb'
      compresslevel = 9
      fileobj = None
      mtime = None
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241206_173002-site1_local-database.sql.gz'
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 114, in <module>
    main()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 20, in main
    click.Group(commands=commands)(prog_name="bench")
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/__init__.py", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/site.py", line 882, in backup
    odb.print_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 339, in print_summary
    backup_summary = self.get_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 318, in get_summary
    "size": get_file_size(self.backup_path_db, format=True),
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/__init__.py", line 952, in get_file_size
    num = os.path.getsize(path)
  File "/usr/lib/python3.10/genericpath.py", line 50, in getsize
    return os.stat(filename).st_size
FileNotFoundError: [Errno 2] No such file or directory: './site1.local/private/backups/20241206_173002-site1_local-database.sql.gz'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241206_173002-site1_local-database.sql.gz

set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241206_233002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-06 23:30:05.058057
Config  : ./site1.local/private/backups/20241206_233002-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241206_233002-site1_local-database.sql.gz         2.2MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241206_233002-site1_local-database.sql.gz

Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7fbce9e636d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7fbce93ab880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7fbce93ab880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7fbce93ab910>
  File "apps/frappe/frappe/utils/backups.py", line 196, in get_backup
    self.delete_if_step_fails(self.copy_site_config, self.backup_path_conf)
      self = <frappe.utils.backups.BackupGenerator object at 0x7fbce93ab910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7fbce93ab910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7fbce93ab910>>
      paths = ('./site1.local/private/backups/20241206_233002-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241206_233002-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7fbce93ab910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7fbce93ab910>>
      paths = ('./site1.local/private/backups/20241206_233002-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241206_233002-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 379, in copy_site_config
    with open(site_config_backup_path, "w") as n, open(site_config_path) as c:
      self = <frappe.utils.backups.BackupGenerator object at 0x7fbce93ab910>
      site_config_backup_path = './site1.local/private/backups/20241206_233002-site1_local-site_config_backup.json'
      site_config_path = './site1.local/site_config.json'
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241206_233002-site1_local-site_config_backup.json'
Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f3baa96b6d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f3ba9eb7880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f3ba9eb7880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7f3ba9eb7910>
  File "apps/frappe/frappe/utils/backups.py", line 195, in get_backup
    self.delete_if_step_fails(self.take_dump, self.backup_path_db)
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3ba9eb7910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3ba9eb7910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f3ba9eb7910>>
      paths = ('./site1.local/private/backups/20241207_053002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241207_053002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3ba9eb7910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f3ba9eb7910>>
      paths = ('./site1.local/private/backups/20241207_053002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241207_053002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 427, in take_dump
    with gzip.open(self.backup_path_db, "wt") as f:
      shlex = <module 'shlex' from '/usr/lib/python3.10/shlex.py'>
      frappe = <module 'frappe' from 'apps/frappe/frappe/__init__.py'>
      get_app_branch = <function get_app_branch at 0x7f3baa95b640>
      gzip_exc = '/usr/bin/gzip'
      database_header_content = ['begin frappe metadata', '[frappe]', 'version = 15.49.1', 'branch = version-15', 'end frappe metadata', '']
      generated_header = '-- begin frappe metadata\n-- [frappe]\n-- version = 15.49.1\n-- branch = version-15\n-- end frappe metadata\n-- \n'
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3ba9eb7910>
  File "/usr/lib/python3.10/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
      filename = './site1.local/private/backups/20241207_053002-site1_local-database.sql.gz'
      mode = 'wt'
      compresslevel = 9
      encoding = None
      errors = None
      newline = None
      gz_mode = 'w'
  File "/usr/lib/python3.10/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
      self = <exception while printing> Traceback (most recent call last):
          File "env/lib/python3.10/site-packages/traceback_with_variables/core.py", line 222, in _to_cropped_str
            raw = print_(obj)
          File "/usr/lib/python3.10/gzip.py", line 229, in __repr__
            s = repr(self.fileobj)
        AttributeError: 'GzipFile' object has no attribute 'fileobj'
        
      filename = './site1.local/private/backups/20241207_053002-site1_local-database.sql.gz'
      mode = 'wb'
      compresslevel = 9
      fileobj = None
      mtime = None
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241207_053002-site1_local-database.sql.gz'
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 114, in <module>
    main()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 20, in main
    click.Group(commands=commands)(prog_name="bench")
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/__init__.py", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/site.py", line 882, in backup
    odb.print_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 339, in print_summary
    backup_summary = self.get_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 318, in get_summary
    "size": get_file_size(self.backup_path_db, format=True),
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/__init__.py", line 952, in get_file_size
    num = os.path.getsize(path)
  File "/usr/lib/python3.10/genericpath.py", line 50, in getsize
    return os.stat(filename).st_size
FileNotFoundError: [Errno 2] No such file or directory: './site1.local/private/backups/20241207_053002-site1_local-database.sql.gz'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241207_053002-site1_local-database.sql.gz

set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241207_113002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-07 11:30:04.479323
Config  : ./site1.local/private/backups/20241207_113002-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241207_113002-site1_local-database.sql.gz         2.2MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241207_113002-site1_local-database.sql.gz

Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f00915776d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f0090abf880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f0090abf880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7f0090abf910>
  File "apps/frappe/frappe/utils/backups.py", line 196, in get_backup
    self.delete_if_step_fails(self.copy_site_config, self.backup_path_conf)
      self = <frappe.utils.backups.BackupGenerator object at 0x7f0090abf910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7f0090abf910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7f0090abf910>>
      paths = ('./site1.local/private/backups/20241207_113002-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241207_113002-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f0090abf910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7f0090abf910>>
      paths = ('./site1.local/private/backups/20241207_113002-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241207_113002-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 379, in copy_site_config
    with open(site_config_backup_path, "w") as n, open(site_config_path) as c:
      self = <frappe.utils.backups.BackupGenerator object at 0x7f0090abf910>
      site_config_backup_path = './site1.local/private/backups/20241207_113002-site1_local-site_config_backup.json'
      site_config_path = './site1.local/site_config.json'
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241207_113002-site1_local-site_config_backup.json'
Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f8b5a86f6d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f8b59dbb880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f8b59dbb880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7f8b59dbb910>
  File "apps/frappe/frappe/utils/backups.py", line 195, in get_backup
    self.delete_if_step_fails(self.take_dump, self.backup_path_db)
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8b59dbb910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8b59dbb910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f8b59dbb910>>
      paths = ('./site1.local/private/backups/20241207_163002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241207_163002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8b59dbb910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f8b59dbb910>>
      paths = ('./site1.local/private/backups/20241207_163002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241207_163002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 427, in take_dump
    with gzip.open(self.backup_path_db, "wt") as f:
      shlex = <module 'shlex' from '/usr/lib/python3.10/shlex.py'>
      frappe = <module 'frappe' from 'apps/frappe/frappe/__init__.py'>
      get_app_branch = <function get_app_branch at 0x7f8b5a85f640>
      gzip_exc = '/usr/bin/gzip'
      database_header_content = ['begin frappe metadata', '[frappe]', 'version = 15.49.1', 'branch = version-15', 'end frappe metadata', '']
      generated_header = '-- begin frappe metadata\n-- [frappe]\n-- version = 15.49.1\n-- branch = version-15\n-- end frappe metadata\n-- \n'
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8b59dbb910>
  File "/usr/lib/python3.10/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
      filename = './site1.local/private/backups/20241207_163002-site1_local-database.sql.gz'
      mode = 'wt'
      compresslevel = 9
      encoding = None
      errors = None
      newline = None
      gz_mode = 'w'
  File "/usr/lib/python3.10/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
      self = <exception while printing> Traceback (most recent call last):
          File "env/lib/python3.10/site-packages/traceback_with_variables/core.py", line 222, in _to_cropped_str
            raw = print_(obj)
          File "/usr/lib/python3.10/gzip.py", line 229, in __repr__
            s = repr(self.fileobj)
        AttributeError: 'GzipFile' object has no attribute 'fileobj'
        
      filename = './site1.local/private/backups/20241207_163002-site1_local-database.sql.gz'
      mode = 'wb'
      compresslevel = 9
      fileobj = None
      mtime = None
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241207_163002-site1_local-database.sql.gz'
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 114, in <module>
    main()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 20, in main
    click.Group(commands=commands)(prog_name="bench")
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/__init__.py", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/site.py", line 882, in backup
    odb.print_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 339, in print_summary
    backup_summary = self.get_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 318, in get_summary
    "size": get_file_size(self.backup_path_db, format=True),
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/__init__.py", line 952, in get_file_size
    num = os.path.getsize(path)
  File "/usr/lib/python3.10/genericpath.py", line 50, in getsize
    return os.stat(filename).st_size
FileNotFoundError: [Errno 2] No such file or directory: './site1.local/private/backups/20241207_163002-site1_local-database.sql.gz'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241207_163002-site1_local-database.sql.gz

set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241207_223002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-07 22:30:05.544441
Config  : ./site1.local/private/backups/20241207_223002-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241207_223002-site1_local-database.sql.gz         2.3MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241207_223002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-07 22:30:05.871351
Config  : ./site1.local/private/backups/20241207_223002-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241207_223002-site1_local-database.sql.gz         2.6MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241208_043001-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-08 04:30:04.211475
Config  : ./site1.local/private/backups/20241208_043001-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241208_043001-site1_local-database.sql.gz         2.6MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241208_043001-site1_local-database.sql.gz

Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f3dc95636d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f3dc8aaf880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f3dc8aaf880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7f3dc8aaf910>
  File "apps/frappe/frappe/utils/backups.py", line 196, in get_backup
    self.delete_if_step_fails(self.copy_site_config, self.backup_path_conf)
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3dc8aaf910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3dc8aaf910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7f3dc8aaf910>>
      paths = ('./site1.local/private/backups/20241208_043001-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241208_043001-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3dc8aaf910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7f3dc8aaf910>>
      paths = ('./site1.local/private/backups/20241208_043001-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241208_043001-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 379, in copy_site_config
    with open(site_config_backup_path, "w") as n, open(site_config_path) as c:
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3dc8aaf910>
      site_config_backup_path = './site1.local/private/backups/20241208_043001-site1_local-site_config_backup.json'
      site_config_path = './site1.local/site_config.json'
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241208_043001-site1_local-site_config_backup.json'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241208_103002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-08 10:30:04.682113
Config  : ./site1.local/private/backups/20241208_103002-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241208_103002-site1_local-database.sql.gz         2.6MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241208_103002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-08 10:30:04.766259
Config  : ./site1.local/private/backups/20241208_103002-site1_local-site_config_backup.json 182.0B
Database: ./site1.local/private/backups/20241208_103002-site1_local-database.sql.gz         2.7MiB
Backup for Site site1.local has been successfully completed
Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f310ec776d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f310e1c3880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f310e1c3880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7f310e1c3910>
  File "apps/frappe/frappe/utils/backups.py", line 195, in get_backup
    self.delete_if_step_fails(self.take_dump, self.backup_path_db)
      self = <frappe.utils.backups.BackupGenerator object at 0x7f310e1c3910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7f310e1c3910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f310e1c3910>>
      paths = ('./site1.local/private/backups/20241208_163001-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241208_163001-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f310e1c3910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f310e1c3910>>
      paths = ('./site1.local/private/backups/20241208_163001-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241208_163001-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 427, in take_dump
    with gzip.open(self.backup_path_db, "wt") as f:
      shlex = <module 'shlex' from '/usr/lib/python3.10/shlex.py'>
      frappe = <module 'frappe' from 'apps/frappe/frappe/__init__.py'>
      get_app_branch = <function get_app_branch at 0x7f310ec67640>
      gzip_exc = '/usr/bin/gzip'
      database_header_content = ['begin frappe metadata', '[frappe]', 'version = 15.49.1', 'branch = version-15', 'end frappe metadata', '']
      generated_header = '-- begin frappe metadata\n-- [frappe]\n-- version = 15.49.1\n-- branch = version-15\n-- end frappe metadata\n-- \n'
      self = <frappe.utils.backups.BackupGenerator object at 0x7f310e1c3910>
  File "/usr/lib/python3.10/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
      filename = './site1.local/private/backups/20241208_163001-site1_local-database.sql.gz'
      mode = 'wt'
      compresslevel = 9
      encoding = None
      errors = None
      newline = None
      gz_mode = 'w'
  File "/usr/lib/python3.10/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
      self = <exception while printing> Traceback (most recent call last):
          File "env/lib/python3.10/site-packages/traceback_with_variables/core.py", line 222, in _to_cropped_str
            raw = print_(obj)
          File "/usr/lib/python3.10/gzip.py", line 229, in __repr__
            s = repr(self.fileobj)
        AttributeError: 'GzipFile' object has no attribute 'fileobj'
        
      filename = './site1.local/private/backups/20241208_163001-site1_local-database.sql.gz'
      mode = 'wb'
      compresslevel = 9
      fileobj = None
      mtime = None
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241208_163001-site1_local-database.sql.gz'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241208_163001-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-08 16:30:05.277096
Config  : ./site1.local/private/backups/20241208_163001-site1_local-site_config_backup.json 249.0B
Database: ./site1.local/private/backups/20241208_163001-site1_local-database.sql.gz         1.4MiB
Backup for Site site1.local has been successfully completed
Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f7aec0776d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f7aeb5c3880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f7aeb5c3880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7f7aeb5c3910>
  File "apps/frappe/frappe/utils/backups.py", line 195, in get_backup
    self.delete_if_step_fails(self.take_dump, self.backup_path_db)
      self = <frappe.utils.backups.BackupGenerator object at 0x7f7aeb5c3910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7f7aeb5c3910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f7aeb5c3910>>
      paths = ('./site1.local/private/backups/20241208_223002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241208_223002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f7aeb5c3910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f7aeb5c3910>>
      paths = ('./site1.local/private/backups/20241208_223002-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241208_223002-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 427, in take_dump
    with gzip.open(self.backup_path_db, "wt") as f:
      shlex = <module 'shlex' from '/usr/lib/python3.10/shlex.py'>
      frappe = <module 'frappe' from 'apps/frappe/frappe/__init__.py'>
      get_app_branch = <function get_app_branch at 0x7f7aec067640>
      gzip_exc = '/usr/bin/gzip'
      database_header_content = ['begin frappe metadata', '[frappe]', 'version = 15.49.1', 'branch = version-15', 'end frappe metadata', '']
      generated_header = '-- begin frappe metadata\n-- [frappe]\n-- version = 15.49.1\n-- branch = version-15\n-- end frappe metadata\n-- \n'
      self = <frappe.utils.backups.BackupGenerator object at 0x7f7aeb5c3910>
  File "/usr/lib/python3.10/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
      filename = './site1.local/private/backups/20241208_223002-site1_local-database.sql.gz'
      mode = 'wt'
      compresslevel = 9
      encoding = None
      errors = None
      newline = None
      gz_mode = 'w'
  File "/usr/lib/python3.10/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
      self = <exception while printing> Traceback (most recent call last):
          File "env/lib/python3.10/site-packages/traceback_with_variables/core.py", line 222, in _to_cropped_str
            raw = print_(obj)
          File "/usr/lib/python3.10/gzip.py", line 229, in __repr__
            s = repr(self.fileobj)
        AttributeError: 'GzipFile' object has no attribute 'fileobj'
        
      filename = './site1.local/private/backups/20241208_223002-site1_local-database.sql.gz'
      mode = 'wb'
      compresslevel = 9
      fileobj = None
      mtime = None
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241208_223002-site1_local-database.sql.gz'
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 114, in <module>
    main()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 20, in main
    click.Group(commands=commands)(prog_name="bench")
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/__init__.py", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/site.py", line 882, in backup
    odb.print_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 339, in print_summary
    backup_summary = self.get_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 318, in get_summary
    "size": get_file_size(self.backup_path_db, format=True),
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/__init__.py", line 952, in get_file_size
    num = os.path.getsize(path)
  File "/usr/lib/python3.10/genericpath.py", line 50, in getsize
    return os.stat(filename).st_size
FileNotFoundError: [Errno 2] No such file or directory: './site1.local/private/backups/20241208_223002-site1_local-database.sql.gz'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241208_223002-site1_local-database.sql.gz

set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241209_043001-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-09 04:30:04.472893
Config  : ./site1.local/private/backups/20241209_043001-site1_local-site_config_backup.json 249.0B
Database: ./site1.local/private/backups/20241209_043001-site1_local-database.sql.gz         2.6MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241209_043001-site1_local-database.sql.gz

Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f7c91e7f6d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f7c913cb880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f7c913cb880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7f7c913cb910>
  File "apps/frappe/frappe/utils/backups.py", line 196, in get_backup
    self.delete_if_step_fails(self.copy_site_config, self.backup_path_conf)
      self = <frappe.utils.backups.BackupGenerator object at 0x7f7c913cb910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7f7c913cb910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7f7c913cb910>>
      paths = ('./site1.local/private/backups/20241209_043001-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241209_043001-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f7c913cb910>
      step = <bound method BackupGenerator.copy_site_config of <frappe.utils.backups.BackupGenerator object at 0x7f7c913cb910>>
      paths = ('./site1.local/private/backups/20241209_043001-site1_local-site_config_backup.json',)
      path = './site1.local/private/backups/20241209_043001-site1_local-site_config_backup.json'
  File "apps/frappe/frappe/utils/backups.py", line 379, in copy_site_config
    with open(site_config_backup_path, "w") as n, open(site_config_path) as c:
      self = <frappe.utils.backups.BackupGenerator object at 0x7f7c913cb910>
      site_config_backup_path = './site1.local/private/backups/20241209_043001-site1_local-site_config_backup.json'
      site_config_path = './site1.local/site_config.json'
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241209_043001-site1_local-site_config_backup.json'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241209_103002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-09 10:30:05.107448
Config  : ./site1.local/private/backups/20241209_103002-site1_local-site_config_backup.json 249.0B
Database: ./site1.local/private/backups/20241209_103002-site1_local-database.sql.gz         2.6MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241209_103002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-09 10:30:05.113630
Config  : ./site1.local/private/backups/20241209_103002-site1_local-site_config_backup.json 249.0B
Database: ./site1.local/private/backups/20241209_103002-site1_local-database.sql.gz         2.8MiB
Backup for Site site1.local has been successfully completed
Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f3d3457f6d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f3d33acb880>
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb.get_backup(older_than, ignore_files, force=force)
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f3d33acb880>
      odb = <frappe.utils.backups.BackupGenerator object at 0x7f3d33acb910>
  File "apps/frappe/frappe/utils/backups.py", line 195, in get_backup
    self.delete_if_step_fails(self.take_dump, self.backup_path_db)
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3d33acb910>
      older_than = 6
      ignore_files = True
      force = True
      last_db = False
      last_file = False
      last_private_file = False
      site_config_backup_path = False
  File "apps/frappe/frappe/utils/backups.py", line 520, in delete_if_step_fails
    raise e
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3d33acb910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f3d33acb910>>
      paths = ('./site1.local/private/backups/20241209_163001-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241209_163001-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 515, in delete_if_step_fails
    step()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3d33acb910>
      step = <bound method BackupGenerator.take_dump of <frappe.utils.backups.BackupGenerator object at 0x7f3d33acb910>>
      paths = ('./site1.local/private/backups/20241209_163001-site1_local-database.sql.gz',)
      path = './site1.local/private/backups/20241209_163001-site1_local-database.sql.gz'
  File "apps/frappe/frappe/utils/backups.py", line 427, in take_dump
    with gzip.open(self.backup_path_db, "wt") as f:
      shlex = <module 'shlex' from '/usr/lib/python3.10/shlex.py'>
      frappe = <module 'frappe' from 'apps/frappe/frappe/__init__.py'>
      get_app_branch = <function get_app_branch at 0x7f3d3456f640>
      gzip_exc = '/usr/bin/gzip'
      database_header_content = ['begin frappe metadata', '[frappe]', 'version = 15.49.1', 'branch = version-15', 'end frappe metadata', '']
      generated_header = '-- begin frappe metadata\n-- [frappe]\n-- version = 15.49.1\n-- branch = version-15\n-- end frappe metadata\n-- \n'
      self = <frappe.utils.backups.BackupGenerator object at 0x7f3d33acb910>
  File "/usr/lib/python3.10/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
      filename = './site1.local/private/backups/20241209_163001-site1_local-database.sql.gz'
      mode = 'wt'
      compresslevel = 9
      encoding = None
      errors = None
      newline = None
      gz_mode = 'w'
  File "/usr/lib/python3.10/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
      self = <exception while printing> Traceback (most recent call last):
          File "env/lib/python3.10/site-packages/traceback_with_variables/core.py", line 222, in _to_cropped_str
            raw = print_(obj)
          File "/usr/lib/python3.10/gzip.py", line 229, in __repr__
            s = repr(self.fileobj)
        AttributeError: 'GzipFile' object has no attribute 'fileobj'
        
      filename = './site1.local/private/backups/20241209_163001-site1_local-database.sql.gz'
      mode = 'wb'
      compresslevel = 9
      fileobj = None
      mtime = None
builtins.PermissionError: [Errno 13] Permission denied: './site1.local/private/backups/20241209_163001-site1_local-database.sql.gz'
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 114, in <module>
    main()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 20, in main
    click.Group(commands=commands)(prog_name="bench")
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/home/afp-arp/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/__init__.py", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/commands/site.py", line 882, in backup
    odb.print_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 339, in print_summary
    backup_summary = self.get_summary()
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/backups.py", line 318, in get_summary
    "size": get_file_size(self.backup_path_db, format=True),
  File "/home/afp-arp/frappe-bench/apps/frappe/frappe/utils/__init__.py", line 952, in get_file_size
    num = os.path.getsize(path)
  File "/usr/lib/python3.10/genericpath.py", line 50, in getsize
    return os.stat(filename).st_size
FileNotFoundError: [Errno 2] No such file or directory: './site1.local/private/backups/20241209_163001-site1_local-database.sql.gz'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241209_163001-site1_local-database.sql.gz

Backup failed for Site site1.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 848, in backup
    odb = scheduled_backup(
      context = {'sites': ['site1.local'], 'force': False, 'verbose': True, 'profile': False}
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7fd9ca3776d0>
      exit_code = 0
      rollback_callback = None
      site = 'site1.local'
  File "apps/frappe/frappe/utils/backups.py", line 568, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7fd9c98bf880>
  File "apps/frappe/frappe/utils/backups.py", line 604, in new_backup
    delete_temp_backups()
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7fd9c98bf880>
  File "apps/frappe/frappe/utils/backups.py", line 641, in delete_temp_backups
    os.remove(this_file_path)
      older_than = 24
      backup_path = './site1.local/private/backups'
      file_list = ['20241209_163001-site1_local-site_config_backup.json', '20241208_163001-site1_local-database.sql.gz', '20241209_103002-site1_local-database.sql.gz', '20241209_103002-site1_local-site_config_backup.json', '20241208_163001-site1_local-site_config_backup.json', '20241208_223002-site1_local-site_config_backup.json']
      this_file = '20241208_163001-site1_local-database.sql.gz'
      this_file_path = './site1.local/private/backups/20241208_163001-site1_local-database.sql.gz'
builtins.FileNotFoundError: [Errno 2] No such file or directory: './site1.local/private/backups/20241208_163001-site1_local-database.sql.gz'
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241209_223001-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-09 22:30:06.434807
Config  : ./site1.local/private/backups/20241209_223001-site1_local-site_config_backup.json 249.0B
Database: ./site1.local/private/backups/20241209_223001-site1_local-database.sql.gz         1.4MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241210_043002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-10 04:30:05.709985
Config  : ./site1.local/private/backups/20241210_043002-site1_local-site_config_backup.json 249.0B
Database: ./site1.local/private/backups/20241210_043002-site1_local-database.sql.gz         2.7MiB
Backup for Site site1.local has been successfully completed
set -o pipefail; /usr/bin/mariadb-dump --user=_c3ed9fbdbab4c049 --host=127.0.0.1 --port=3306 --password=********** --single-transaction --quick --lock-tables=false _c3ed9fbdbab4c049 | /usr/bin/gzip >> ./site1.local/private/backups/20241210_043002-site1_local-database.sql.gz

Backup Summary for site1.local at 2024-12-10 04:30:05.775307
Config  : ./site1.local/private/backups/20241210_043002-site1_local-site_config_backup.json 249.0B
Database: ./site1.local/private/backups/20241210_043002-site1_local-database.sql.gz         2.9MiB
Backup for Site site1.local has been successfully completed
